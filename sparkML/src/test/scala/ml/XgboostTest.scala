/**
  * create by colin on 2018/7/23
  */

import ml.dmlc.xgboost4j.scala.spark.{XGBoost, XGBoostClassificationModel}
import org.apache.spark.SparkConf
import ml.dmlc.xgboost4j.scala.Booster
import org.apache.spark.ml.feature.VectorAssembler
import org.apache.spark.mllib.linalg.Vectors
import org.apache.spark.mllib.regression.LabeledPoint
import org.apache.spark.sql.SparkSession
import util.SparkTools

import scala.collection.SortedMap
import scala.collection.immutable.TreeMap

object XgboostTest extends SparkTools {

  import spark.implicits._
  import org.apache.spark.sql.functions._
  import spark.sql

  //    val dataList: List[(Double, String, Double, Double, String, Double, Double, Double, Double)] = List(
  //      (0, "male", 37, 10, "no", 3, 18, 7, 4),
  //      (0, "female", 27, 4, "no", 4, 14, 6, 4),
  //      (0, "female", 32, 15, "yes", 1, 12, 1, 4),
  //      (0, "male", 57, 15, "yes", 5, 18, 6, 5),
  //      (0, "male", 22, 0.75, "no", 2, 17, 6, 3),
  //      (0, "female", 32, 1.5, "no", 2, 17, 5, 5),
  //      (0, "female", 22, 0.75, "no", 2, 12, 1, 3),
  //      (0, "male", 57, 15, "yes", 2, 14, 4, 4),
  //      (0, "female", 32, 15, "yes", 4, 16, 1, 2),
  //      (0, "male", 22, 1.5, "no", 4, 14, 4, 5),
  //      (0, "male", 37, 15, "yes", 2, 20, 7, 2),
  //      (0, "male", 27, 4, "yes", 4, 18, 6, 4),
  //      (0, "male", 47, 15, "yes", 5, 17, 6, 4),
  //      (0, "female", 22, 1.5, "no", 2, 17, 5, 4),
  //      (0, "female", 27, 4, "no", 4, 14, 5, 4),
  //      (0, "female", 37, 15, "yes", 1, 17, 5, 5),
  //      (0, "female", 37, 15, "yes", 2, 18, 4, 3),
  //      (0, "female", 22, 0.75, "no", 3, 16, 5, 4),
  //      (0, "female", 22, 1.5, "no", 2, 16, 5, 5),
  //      (0, "female", 27, 10, "yes", 2, 14, 1, 5),
  //      (0, "female", 22, 1.5, "no", 2, 16, 5, 5),
  //      (0, "female", 22, 1.5, "no", 2, 16, 5, 5),
  //      (0, "female", 27, 10, "yes", 4, 16, 5, 4),
  //      (0, "female", 32, 10, "yes", 3, 14, 1, 5),
  //      (0, "male", 37, 4, "yes", 2, 20, 6, 4),
  //      (0, "female", 22, 1.5, "no", 2, 18, 5, 5),
  //      (0, "female", 27, 7, "no", 4, 16, 1, 5),
  //      (0, "male", 42, 15, "yes", 5, 20, 6, 4),
  //      (0, "male", 27, 4, "yes", 3, 16, 5, 5),
  //      (0, "female", 27, 4, "yes", 3, 17, 5, 4),
  //      (0, "male", 42, 15, "yes", 4, 20, 6, 3),
  //      (0, "female", 22, 1.5, "no", 3, 16, 5, 5),
  //      (0, "male", 27, 0.417, "no", 4, 17, 6, 4),
  //      (0, "female", 42, 15, "yes", 5, 14, 5, 4),
  //      (0, "male", 32, 4, "yes", 1, 18, 6, 4),
  //      (0, "female", 22, 1.5, "no", 4, 16, 5, 3),
  //      (0, "female", 42, 15, "yes", 3, 12, 1, 4),
  //      (0, "female", 22, 4, "no", 4, 17, 5, 5),
  //      (0, "male", 22, 1.5, "yes", 1, 14, 3, 5),
  //      (0, "female", 22, 0.75, "no", 3, 16, 1, 5),
  //      (0, "male", 32, 10, "yes", 5, 20, 6, 5),
  //      (0, "male", 52, 15, "yes", 5, 18, 6, 3),
  //      (0, "female", 22, 0.417, "no", 5, 14, 1, 4),
  //      (0, "female", 27, 4, "yes", 2, 18, 6, 1),
  //      (0, "female", 32, 7, "yes", 5, 17, 5, 3),
  //      (0, "male", 22, 4, "no", 3, 16, 5, 5),
  //      (0, "female", 27, 7, "yes", 4, 18, 6, 5),
  //      (0, "female", 42, 15, "yes", 2, 18, 5, 4),
  //      (0, "male", 27, 1.5, "yes", 4, 16, 3, 5),
  //      (0, "male", 42, 15, "yes", 2, 20, 6, 4),
  //      (0, "female", 22, 0.75, "no", 5, 14, 3, 5),
  //      (0, "male", 32, 7, "yes", 2, 20, 6, 4),
  //      (0, "male", 27, 4, "yes", 5, 20, 6, 5),
  //      (0, "male", 27, 10, "yes", 4, 20, 6, 4),
  //      (0, "male", 22, 4, "no", 1, 18, 5, 5),
  //      (0, "female", 37, 15, "yes", 4, 14, 3, 1),
  //      (0, "male", 22, 1.5, "yes", 5, 16, 4, 4),
  //      (0, "female", 37, 15, "yes", 4, 17, 1, 5),
  //      (0, "female", 27, 0.75, "no", 4, 17, 5, 4),
  //      (0, "male", 32, 10, "yes", 4, 20, 6, 4),
  //      (0, "female", 47, 15, "yes", 5, 14, 7, 2),
  //      (0, "male", 37, 10, "yes", 3, 20, 6, 4),
  //      (0, "female", 22, 0.75, "no", 2, 16, 5, 5),
  //      (0, "male", 27, 4, "no", 2, 18, 4, 5),
  //      (0, "male", 32, 7, "no", 4, 20, 6, 4),
  //      (0, "male", 42, 15, "yes", 2, 17, 3, 5),
  //      (0, "male", 37, 10, "yes", 4, 20, 6, 4),
  //      (0, "female", 47, 15, "yes", 3, 17, 6, 5),
  //      (0, "female", 22, 1.5, "no", 5, 16, 5, 5),
  //      (0, "female", 27, 1.5, "no", 2, 16, 6, 4),
  //      (0, "female", 27, 4, "no", 3, 17, 5, 5),
  //      (0, "female", 32, 10, "yes", 5, 14, 4, 5),
  //      (0, "female", 22, 0.125, "no", 2, 12, 5, 5),
  //      (0, "male", 47, 15, "yes", 4, 14, 4, 3),
  //      (0, "male", 32, 15, "yes", 1, 14, 5, 5),
  //      (0, "male", 27, 7, "yes", 4, 16, 5, 5),
  //      (0, "female", 22, 1.5, "yes", 3, 16, 5, 5),
  //      (0, "male", 27, 4, "yes", 3, 17, 6, 5),
  //      (0, "female", 22, 1.5, "no", 3, 16, 5, 5),
  //      (0, "male", 57, 15, "yes", 2, 14, 7, 2),
  //      (0, "male", 17.5, 1.5, "yes", 3, 18, 6, 5),
  //      (0, "male", 57, 15, "yes", 4, 20, 6, 5),
  //      (0, "female", 22, 0.75, "no", 2, 16, 3, 4),
  //      (0, "male", 42, 4, "no", 4, 17, 3, 3),
  //      (0, "female", 22, 1.5, "yes", 4, 12, 1, 5),
  //      (0, "female", 22, 0.417, "no", 1, 17, 6, 4),
  //      (0, "female", 32, 15, "yes", 4, 17, 5, 5),
  //      (0, "female", 27, 1.5, "no", 3, 18, 5, 2),
  //      (0, "female", 22, 1.5, "yes", 3, 14, 1, 5),
  //      (0, "female", 37, 15, "yes", 3, 14, 1, 4),
  //      (0, "female", 32, 15, "yes", 4, 14, 3, 4),
  //      (0, "male", 37, 10, "yes", 2, 14, 5, 3),
  //      (0, "male", 37, 10, "yes", 4, 16, 5, 4),
  //      (0, "male", 57, 15, "yes", 5, 20, 5, 3),
  //      (0, "male", 27, 0.417, "no", 1, 16, 3, 4),
  //      (0, "female", 42, 15, "yes", 5, 14, 1, 5),
  //      (0, "male", 57, 15, "yes", 3, 16, 6, 1),
  //      (0, "male", 37, 10, "yes", 1, 16, 6, 4),
  //      (0, "male", 37, 15, "yes", 3, 17, 5, 5),
  //      (0, "male", 37, 15, "yes", 4, 20, 6, 5),
  //      (0, "female", 27, 10, "yes", 5, 14, 1, 5),
  //      (0, "male", 37, 10, "yes", 2, 18, 6, 4),
  //      (0, "female", 22, 0.125, "no", 4, 12, 4, 5),
  //      (0, "male", 57, 15, "yes", 5, 20, 6, 5),
  //      (0, "female", 37, 15, "yes", 4, 18, 6, 4),
  //      (0, "male", 22, 4, "yes", 4, 14, 6, 4),
  //      (0, "male", 27, 7, "yes", 4, 18, 5, 4),
  //      (0, "male", 57, 15, "yes", 4, 20, 5, 4),
  //      (0, "male", 32, 15, "yes", 3, 14, 6, 3),
  //      (0, "female", 22, 1.5, "no", 2, 14, 5, 4),
  //      (0, "female", 32, 7, "yes", 4, 17, 1, 5),
  //      (0, "female", 37, 15, "yes", 4, 17, 6, 5),
  //      (0, "female", 32, 1.5, "no", 5, 18, 5, 5),
  //      (0, "male", 42, 10, "yes", 5, 20, 7, 4),
  //      (0, "female", 27, 7, "no", 3, 16, 5, 4),
  //      (0, "male", 37, 15, "no", 4, 20, 6, 5),
  //      (0, "male", 37, 15, "yes", 4, 14, 3, 2),
  //      (0, "male", 32, 10, "no", 5, 18, 6, 4),
  //      (0, "female", 22, 0.75, "no", 4, 16, 1, 5),
  //      (0, "female", 27, 7, "yes", 4, 12, 2, 4),
  //      (0, "female", 27, 7, "yes", 2, 16, 2, 5),
  //      (0, "female", 42, 15, "yes", 5, 18, 5, 4),
  //      (0, "male", 42, 15, "yes", 4, 17, 5, 3),
  //      (0, "female", 27, 7, "yes", 2, 16, 1, 2),
  //      (0, "female", 22, 1.5, "no", 3, 16, 5, 5),
  //      (0, "male", 37, 15, "yes", 5, 20, 6, 5),
  //      (0, "female", 22, 0.125, "no", 2, 14, 4, 5),
  //      (0, "male", 27, 1.5, "no", 4, 16, 5, 5),
  //      (0, "male", 32, 1.5, "no", 2, 18, 6, 5),
  //      (0, "male", 27, 1.5, "no", 2, 17, 6, 5),
  //      (0, "female", 27, 10, "yes", 4, 16, 1, 3),
  //      (0, "male", 42, 15, "yes", 4, 18, 6, 5),
  //      (0, "female", 27, 1.5, "no", 2, 16, 6, 5),
  //      (0, "male", 27, 4, "no", 2, 18, 6, 3),
  //      (0, "female", 32, 10, "yes", 3, 14, 5, 3),
  //      (0, "female", 32, 15, "yes", 3, 18, 5, 4),
  //      (0, "female", 22, 0.75, "no", 2, 18, 6, 5),
  //      (0, "female", 37, 15, "yes", 2, 16, 1, 4),
  //      (0, "male", 27, 4, "yes", 4, 20, 5, 5),
  //      (0, "male", 27, 4, "no", 1, 20, 5, 4),
  //      (0, "female", 27, 10, "yes", 2, 12, 1, 4),
  //      (0, "female", 32, 15, "yes", 5, 18, 6, 4),
  //      (0, "male", 27, 7, "yes", 5, 12, 5, 3),
  //      (0, "male", 52, 15, "yes", 2, 18, 5, 4),
  //      (0, "male", 27, 4, "no", 3, 20, 6, 3),
  //      (0, "male", 37, 4, "yes", 1, 18, 5, 4),
  //      (0, "male", 27, 4, "yes", 4, 14, 5, 4),
  //      (0, "female", 52, 15, "yes", 5, 12, 1, 3),
  //      (0, "female", 57, 15, "yes", 4, 16, 6, 4),
  //      (0, "male", 27, 7, "yes", 1, 16, 5, 4),
  //      (0, "male", 37, 7, "yes", 4, 20, 6, 3),
  //      (0, "male", 22, 0.75, "no", 2, 14, 4, 3),
  //      (0, "male", 32, 4, "yes", 2, 18, 5, 3),
  //      (0, "male", 37, 15, "yes", 4, 20, 6, 3),
  //      (0, "male", 22, 0.75, "yes", 2, 14, 4, 3),
  //      (0, "male", 42, 15, "yes", 4, 20, 6, 3),
  //      (0, "female", 52, 15, "yes", 5, 17, 1, 1),
  //      (0, "female", 37, 15, "yes", 4, 14, 1, 2),
  //      (0, "male", 27, 7, "yes", 4, 14, 5, 3),
  //      (0, "male", 32, 4, "yes", 2, 16, 5, 5),
  //      (0, "female", 27, 4, "yes", 2, 18, 6, 5),
  //      (0, "female", 27, 4, "yes", 2, 18, 5, 5),
  //      (0, "male", 37, 15, "yes", 5, 18, 6, 5),
  //      (0, "female", 47, 15, "yes", 5, 12, 5, 4),
  //      (0, "female", 32, 10, "yes", 3, 17, 1, 4),
  //      (0, "female", 27, 1.5, "yes", 4, 17, 1, 2),
  //      (0, "female", 57, 15, "yes", 2, 18, 5, 2),
  //      (0, "female", 22, 1.5, "no", 4, 14, 5, 4),
  //      (0, "male", 42, 15, "yes", 3, 14, 3, 4),
  //      (0, "male", 57, 15, "yes", 4, 9, 2, 2),
  //      (0, "male", 57, 15, "yes", 4, 20, 6, 5),
  //      (0, "female", 22, 0.125, "no", 4, 14, 4, 5),
  //      (0, "female", 32, 10, "yes", 4, 14, 1, 5),
  //      (0, "female", 42, 15, "yes", 3, 18, 5, 4),
  //      (0, "female", 27, 1.5, "no", 2, 18, 6, 5),
  //      (0, "male", 32, 0.125, "yes", 2, 18, 5, 2),
  //      (0, "female", 27, 4, "no", 3, 16, 5, 4),
  //      (0, "female", 27, 10, "yes", 2, 16, 1, 4),
  //      (0, "female", 32, 7, "yes", 4, 16, 1, 3),
  //      (0, "female", 37, 15, "yes", 4, 14, 5, 4),
  //      (0, "female", 42, 15, "yes", 5, 17, 6, 2),
  //      (0, "male", 32, 1.5, "yes", 4, 14, 6, 5),
  //      (0, "female", 32, 4, "yes", 3, 17, 5, 3),
  //      (0, "female", 37, 7, "no", 4, 18, 5, 5),
  //      (0, "female", 22, 0.417, "yes", 3, 14, 3, 5),
  //      (0, "female", 27, 7, "yes", 4, 14, 1, 5),
  //      (0, "male", 27, 0.75, "no", 3, 16, 5, 5),
  //      (0, "male", 27, 4, "yes", 2, 20, 5, 5),
  //      (0, "male", 32, 10, "yes", 4, 16, 4, 5),
  //      (0, "male", 32, 15, "yes", 1, 14, 5, 5),
  //      (0, "male", 22, 0.75, "no", 3, 17, 4, 5),
  //      (0, "female", 27, 7, "yes", 4, 17, 1, 4),
  //      (0, "male", 27, 0.417, "yes", 4, 20, 5, 4),
  //      (0, "male", 37, 15, "yes", 4, 20, 5, 4),
  //      (0, "female", 37, 15, "yes", 2, 14, 1, 3),
  //      (0, "male", 22, 4, "yes", 1, 18, 5, 4),
  //      (0, "male", 37, 15, "yes", 4, 17, 5, 3),
  //      (0, "female", 22, 1.5, "no", 2, 14, 4, 5),
  //      (0, "male", 52, 15, "yes", 4, 14, 6, 2),
  //      (0, "female", 22, 1.5, "no", 4, 17, 5, 5),
  //      (0, "male", 32, 4, "yes", 5, 14, 3, 5),
  //      (0, "male", 32, 4, "yes", 2, 14, 3, 5),
  //      (0, "female", 22, 1.5, "no", 3, 16, 6, 5),
  //      (0, "male", 27, 0.75, "no", 2, 18, 3, 3),
  //      (0, "female", 22, 7, "yes", 2, 14, 5, 2),
  //      (0, "female", 27, 0.75, "no", 2, 17, 5, 3),
  //      (0, "female", 37, 15, "yes", 4, 12, 1, 2),
  //      (0, "female", 22, 1.5, "no", 1, 14, 1, 5),
  //      (0, "female", 37, 10, "no", 2, 12, 4, 4),
  //      (0, "female", 37, 15, "yes", 4, 18, 5, 3),
  //      (0, "female", 42, 15, "yes", 3, 12, 3, 3),
  //      (0, "male", 22, 4, "no", 2, 18, 5, 5),
  //      (0, "male", 52, 7, "yes", 2, 20, 6, 2),
  //      (0, "male", 27, 0.75, "no", 2, 17, 5, 5),
  //      (0, "female", 27, 4, "no", 2, 17, 4, 5),
  //      (0, "male", 42, 1.5, "no", 5, 20, 6, 5),
  //      (0, "male", 22, 1.5, "no", 4, 17, 6, 5),
  //      (0, "male", 22, 4, "no", 4, 17, 5, 3),
  //      (0, "female", 22, 4, "yes", 1, 14, 5, 4),
  //      (0, "male", 37, 15, "yes", 5, 20, 4, 5),
  //      (0, "female", 37, 10, "yes", 3, 16, 6, 3),
  //      (0, "male", 42, 15, "yes", 4, 17, 6, 5),
  //      (0, "female", 47, 15, "yes", 4, 17, 5, 5),
  //      (0, "male", 22, 1.5, "no", 4, 16, 5, 4),
  //      (0, "female", 32, 10, "yes", 3, 12, 1, 4),
  //      (0, "female", 22, 7, "yes", 1, 14, 3, 5),
  //      (0, "female", 32, 10, "yes", 4, 17, 5, 4),
  //      (0, "male", 27, 1.5, "yes", 2, 16, 2, 4),
  //      (0, "male", 37, 15, "yes", 4, 14, 5, 5),
  //      (0, "male", 42, 4, "yes", 3, 14, 4, 5),
  //      (0, "female", 37, 15, "yes", 5, 14, 5, 4),
  //      (0, "female", 32, 7, "yes", 4, 17, 5, 5),
  //      (0, "female", 42, 15, "yes", 4, 18, 6, 5),
  //      (0, "male", 27, 4, "no", 4, 18, 6, 4),
  //      (0, "male", 22, 0.75, "no", 4, 18, 6, 5),
  //      (0, "male", 27, 4, "yes", 4, 14, 5, 3),
  //      (0, "female", 22, 0.75, "no", 5, 18, 1, 5),
  //      (0, "female", 52, 15, "yes", 5, 9, 5, 5),
  //      (0, "male", 32, 10, "yes", 3, 14, 5, 5),
  //      (0, "female", 37, 15, "yes", 4, 16, 4, 4),
  //      (0, "male", 32, 7, "yes", 2, 20, 5, 4),
  //      (0, "female", 42, 15, "yes", 3, 18, 1, 4),
  //      (0, "male", 32, 15, "yes", 1, 16, 5, 5),
  //      (0, "male", 27, 4, "yes", 3, 18, 5, 5),
  //      (0, "female", 32, 15, "yes", 4, 12, 3, 4),
  //      (0, "male", 22, 0.75, "yes", 3, 14, 2, 4),
  //      (0, "female", 22, 1.5, "no", 3, 16, 5, 3),
  //      (0, "female", 42, 15, "yes", 4, 14, 3, 5),
  //      (0, "female", 52, 15, "yes", 3, 16, 5, 4),
  //      (0, "male", 37, 15, "yes", 5, 20, 6, 4),
  //      (0, "female", 47, 15, "yes", 4, 12, 2, 3),
  //      (0, "male", 57, 15, "yes", 2, 20, 6, 4),
  //      (0, "male", 32, 7, "yes", 4, 17, 5, 5),
  //      (0, "female", 27, 7, "yes", 4, 17, 1, 4),
  //      (0, "male", 22, 1.5, "no", 1, 18, 6, 5),
  //      (0, "female", 22, 4, "yes", 3, 9, 1, 4),
  //      (0, "female", 22, 1.5, "no", 2, 14, 1, 5),
  //      (0, "male", 42, 15, "yes", 2, 20, 6, 4),
  //      (0, "male", 57, 15, "yes", 4, 9, 2, 4),
  //      (0, "female", 27, 7, "yes", 2, 18, 1, 5),
  //      (0, "female", 22, 4, "yes", 3, 14, 1, 5),
  //      (0, "male", 37, 15, "yes", 4, 14, 5, 3),
  //      (0, "male", 32, 7, "yes", 1, 18, 6, 4),
  //      (0, "female", 22, 1.5, "no", 2, 14, 5, 5),
  //      (0, "female", 22, 1.5, "yes", 3, 12, 1, 3),
  //      (0, "male", 52, 15, "yes", 2, 14, 5, 5),
  //      (0, "female", 37, 15, "yes", 2, 14, 1, 1),
  //      (0, "female", 32, 10, "yes", 2, 14, 5, 5),
  //      (0, "male", 42, 15, "yes", 4, 20, 4, 5),
  //      (0, "female", 27, 4, "yes", 3, 18, 4, 5),
  //      (0, "male", 37, 15, "yes", 4, 20, 6, 5),
  //      (0, "male", 27, 1.5, "no", 3, 18, 5, 5),
  //      (0, "female", 22, 0.125, "no", 2, 16, 6, 3),
  //      (0, "male", 32, 10, "yes", 2, 20, 6, 3),
  //      (0, "female", 27, 4, "no", 4, 18, 5, 4),
  //      (0, "female", 27, 7, "yes", 2, 12, 5, 1),
  //      (0, "male", 32, 4, "yes", 5, 18, 6, 3),
  //      (0, "female", 37, 15, "yes", 2, 17, 5, 5),
  //      (0, "male", 47, 15, "no", 4, 20, 6, 4),
  //      (0, "male", 27, 1.5, "no", 1, 18, 5, 5),
  //      (0, "male", 37, 15, "yes", 4, 20, 6, 4),
  //      (0, "female", 32, 15, "yes", 4, 18, 1, 4),
  //      (0, "female", 32, 7, "yes", 4, 17, 5, 4),
  //      (0, "female", 42, 15, "yes", 3, 14, 1, 3),
  //      (0, "female", 27, 7, "yes", 3, 16, 1, 4),
  //      (0, "male", 27, 1.5, "no", 3, 16, 4, 2),
  //      (0, "male", 22, 1.5, "no", 3, 16, 3, 5),
  //      (0, "male", 27, 4, "yes", 3, 16, 4, 2),
  //      (0, "female", 27, 7, "yes", 3, 12, 1, 2),
  //      (0, "female", 37, 15, "yes", 2, 18, 5, 4),
  //      (0, "female", 37, 7, "yes", 3, 14, 4, 4),
  //      (0, "male", 22, 1.5, "no", 2, 16, 5, 5),
  //      (0, "male", 37, 15, "yes", 5, 20, 5, 4),
  //      (0, "female", 22, 1.5, "no", 4, 16, 5, 3),
  //      (0, "female", 32, 10, "yes", 4, 16, 1, 5),
  //      (0, "male", 27, 4, "no", 2, 17, 5, 3),
  //      (0, "female", 22, 0.417, "no", 4, 14, 5, 5),
  //      (0, "female", 27, 4, "no", 2, 18, 5, 5),
  //      (0, "male", 37, 15, "yes", 4, 18, 5, 3),
  //      (0, "male", 37, 10, "yes", 5, 20, 7, 4),
  //      (0, "female", 27, 7, "yes", 2, 14, 4, 2),
  //      (0, "male", 32, 4, "yes", 2, 16, 5, 5),
  //      (0, "male", 32, 4, "yes", 2, 16, 6, 4),
  //      (0, "male", 22, 1.5, "no", 3, 18, 4, 5),
  //      (0, "female", 22, 4, "yes", 4, 14, 3, 4),
  //      (0, "female", 17.5, 0.75, "no", 2, 18, 5, 4),
  //      (0, "male", 32, 10, "yes", 4, 20, 4, 5),
  //      (0, "female", 32, 0.75, "no", 5, 14, 3, 3),
  //      (0, "male", 37, 15, "yes", 4, 17, 5, 3),
  //      (0, "male", 32, 4, "no", 3, 14, 4, 5),
  //      (0, "female", 27, 1.5, "no", 2, 17, 3, 2),
  //      (0, "female", 22, 7, "yes", 4, 14, 1, 5),
  //      (0, "male", 47, 15, "yes", 5, 14, 6, 5),
  //      (0, "male", 27, 4, "yes", 1, 16, 4, 4),
  //      (0, "female", 37, 15, "yes", 5, 14, 1, 3),
  //      (0, "male", 42, 4, "yes", 4, 18, 5, 5),
  //      (0, "female", 32, 4, "yes", 2, 14, 1, 5),
  //      (0, "male", 52, 15, "yes", 2, 14, 7, 4),
  //      (0, "female", 22, 1.5, "no", 2, 16, 1, 4),
  //      (0, "male", 52, 15, "yes", 4, 12, 2, 4),
  //      (0, "female", 22, 0.417, "no", 3, 17, 1, 5),
  //      (0, "female", 22, 1.5, "no", 2, 16, 5, 5),
  //      (0, "male", 27, 4, "yes", 4, 20, 6, 4),
  //      (0, "female", 32, 15, "yes", 4, 14, 1, 5),
  //      (0, "female", 27, 1.5, "no", 2, 16, 3, 5),
  //      (0, "male", 32, 4, "no", 1, 20, 6, 5),
  //      (0, "male", 37, 15, "yes", 3, 20, 6, 4),
  //      (0, "female", 32, 10, "no", 2, 16, 6, 5),
  //      (0, "female", 32, 10, "yes", 5, 14, 5, 5),
  //      (0, "male", 37, 1.5, "yes", 4, 18, 5, 3),
  //      (0, "male", 32, 1.5, "no", 2, 18, 4, 4),
  //      (0, "female", 32, 10, "yes", 4, 14, 1, 4),
  //      (0, "female", 47, 15, "yes", 4, 18, 5, 4),
  //      (0, "female", 27, 10, "yes", 5, 12, 1, 5),
  //      (0, "male", 27, 4, "yes", 3, 16, 4, 5),
  //      (0, "female", 37, 15, "yes", 4, 12, 4, 2),
  //      (0, "female", 27, 0.75, "no", 4, 16, 5, 5),
  //      (0, "female", 37, 15, "yes", 4, 16, 1, 5),
  //      (0, "female", 32, 15, "yes", 3, 16, 1, 5),
  //      (0, "female", 27, 10, "yes", 2, 16, 1, 5),
  //      (0, "male", 27, 7, "no", 2, 20, 6, 5),
  //      (0, "female", 37, 15, "yes", 2, 14, 1, 3),
  //      (0, "male", 27, 1.5, "yes", 2, 17, 4, 4),
  //      (0, "female", 22, 0.75, "yes", 2, 14, 1, 5),
  //      (0, "male", 22, 4, "yes", 4, 14, 2, 4),
  //      (0, "male", 42, 0.125, "no", 4, 17, 6, 4),
  //      (0, "male", 27, 1.5, "yes", 4, 18, 6, 5),
  //      (0, "male", 27, 7, "yes", 3, 16, 6, 3),
  //      (0, "female", 52, 15, "yes", 4, 14, 1, 3),
  //      (0, "male", 27, 1.5, "no", 5, 20, 5, 2),
  //      (0, "female", 27, 1.5, "no", 2, 16, 5, 5),
  //      (0, "female", 27, 1.5, "no", 3, 17, 5, 5),
  //      (0, "male", 22, 0.125, "no", 5, 16, 4, 4),
  //      (0, "female", 27, 4, "yes", 4, 16, 1, 5),
  //      (0, "female", 27, 4, "yes", 4, 12, 1, 5),
  //      (0, "female", 47, 15, "yes", 2, 14, 5, 5),
  //      (0, "female", 32, 15, "yes", 3, 14, 5, 3),
  //      (0, "male", 42, 7, "yes", 2, 16, 5, 5),
  //      (0, "male", 22, 0.75, "no", 4, 16, 6, 4),
  //      (0, "male", 27, 0.125, "no", 3, 20, 6, 5),
  //      (0, "male", 32, 10, "yes", 3, 20, 6, 5),
  //      (0, "female", 22, 0.417, "no", 5, 14, 4, 5),
  //      (0, "female", 47, 15, "yes", 5, 14, 1, 4),
  //      (0, "female", 32, 10, "yes", 3, 14, 1, 5),
  //      (0, "male", 57, 15, "yes", 4, 17, 5, 5),
  //      (0, "male", 27, 4, "yes", 3, 20, 6, 5),
  //      (0, "female", 32, 7, "yes", 4, 17, 1, 5),
  //      (0, "female", 37, 10, "yes", 4, 16, 1, 5),
  //      (0, "female", 32, 10, "yes", 1, 18, 1, 4),
  //      (0, "female", 22, 4, "no", 3, 14, 1, 4),
  //      (0, "female", 27, 7, "yes", 4, 14, 3, 2),
  //      (0, "male", 57, 15, "yes", 5, 18, 5, 2),
  //      (0, "male", 32, 7, "yes", 2, 18, 5, 5),
  //      (0, "female", 27, 1.5, "no", 4, 17, 1, 3),
  //      (0, "male", 22, 1.5, "no", 4, 14, 5, 5),
  //      (0, "female", 22, 1.5, "yes", 4, 14, 5, 4),
  //      (0, "female", 32, 7, "yes", 3, 16, 1, 5),
  //      (0, "female", 47, 15, "yes", 3, 16, 5, 4),
  //      (0, "female", 22, 0.75, "no", 3, 16, 1, 5),
  //      (0, "female", 22, 1.5, "yes", 2, 14, 5, 5),
  //      (0, "female", 27, 4, "yes", 1, 16, 5, 5),
  //      (0, "male", 52, 15, "yes", 4, 16, 5, 5),
  //      (0, "male", 32, 10, "yes", 4, 20, 6, 5),
  //      (0, "male", 47, 15, "yes", 4, 16, 6, 4),
  //      (0, "female", 27, 7, "yes", 2, 14, 1, 2),
  //      (0, "female", 22, 1.5, "no", 4, 14, 4, 5),
  //      (0, "female", 32, 10, "yes", 2, 16, 5, 4),
  //      (0, "female", 22, 0.75, "no", 2, 16, 5, 4),
  //      (0, "female", 22, 1.5, "no", 2, 16, 5, 5),
  //      (0, "female", 42, 15, "yes", 3, 18, 6, 4),
  //      (0, "female", 27, 7, "yes", 5, 14, 4, 5),
  //      (0, "male", 42, 15, "yes", 4, 16, 4, 4),
  //      (0, "female", 57, 15, "yes", 3, 18, 5, 2),
  //      (0, "male", 42, 15, "yes", 3, 18, 6, 2),
  //      (0, "female", 32, 7, "yes", 2, 14, 1, 2),
  //      (0, "male", 22, 4, "no", 5, 12, 4, 5),
  //      (0, "female", 22, 1.5, "no", 1, 16, 6, 5),
  //      (0, "female", 22, 0.75, "no", 1, 14, 4, 5),
  //      (0, "female", 32, 15, "yes", 4, 12, 1, 5),
  //      (0, "male", 22, 1.5, "no", 2, 18, 5, 3),
  //      (0, "male", 27, 4, "yes", 5, 17, 2, 5),
  //      (0, "female", 27, 4, "yes", 4, 12, 1, 5),
  //      (0, "male", 42, 15, "yes", 5, 18, 5, 4),
  //      (0, "male", 32, 1.5, "no", 2, 20, 7, 3),
  //      (0, "male", 57, 15, "no", 4, 9, 3, 1),
  //      (0, "male", 37, 7, "no", 4, 18, 5, 5),
  //      (0, "male", 52, 15, "yes", 2, 17, 5, 4),
  //      (0, "male", 47, 15, "yes", 4, 17, 6, 5),
  //      (0, "female", 27, 7, "no", 2, 17, 5, 4),
  //      (0, "female", 27, 7, "yes", 4, 14, 5, 5),
  //      (0, "female", 22, 4, "no", 2, 14, 3, 3),
  //      (0, "male", 37, 7, "yes", 2, 20, 6, 5),
  //      (0, "male", 27, 7, "no", 4, 12, 4, 3),
  //      (0, "male", 42, 10, "yes", 4, 18, 6, 4),
  //      (0, "female", 22, 1.5, "no", 3, 14, 1, 5),
  //      (0, "female", 22, 4, "yes", 2, 14, 1, 3),
  //      (0, "female", 57, 15, "no", 4, 20, 6, 5),
  //      (0, "male", 37, 15, "yes", 4, 14, 4, 3),
  //      (0, "female", 27, 7, "yes", 3, 18, 5, 5),
  //      (0, "female", 17.5, 10, "no", 4, 14, 4, 5),
  //      (0, "male", 22, 4, "yes", 4, 16, 5, 5),
  //      (0, "female", 27, 4, "yes", 2, 16, 1, 4),
  //      (0, "female", 37, 15, "yes", 2, 14, 5, 1),
  //      (0, "female", 22, 1.5, "no", 5, 14, 1, 4),
  //      (0, "male", 27, 7, "yes", 2, 20, 5, 4),
  //      (0, "male", 27, 4, "yes", 4, 14, 5, 5),
  //      (0, "male", 22, 0.125, "no", 1, 16, 3, 5),
  //      (0, "female", 27, 7, "yes", 4, 14, 1, 4),
  //      (0, "female", 32, 15, "yes", 5, 16, 5, 3),
  //      (0, "male", 32, 10, "yes", 4, 18, 5, 4),
  //      (0, "female", 32, 15, "yes", 2, 14, 3, 4),
  //      (0, "female", 22, 1.5, "no", 3, 17, 5, 5),
  //      (0, "male", 27, 4, "yes", 4, 17, 4, 4),
  //      (0, "female", 52, 15, "yes", 5, 14, 1, 5),
  //      (0, "female", 27, 7, "yes", 2, 12, 1, 2),
  //      (0, "female", 27, 7, "yes", 3, 12, 1, 4),
  //      (0, "female", 42, 15, "yes", 2, 14, 1, 4),
  //      (0, "female", 42, 15, "yes", 4, 14, 5, 4),
  //      (0, "male", 27, 7, "yes", 4, 14, 3, 3),
  //      (0, "male", 27, 7, "yes", 2, 20, 6, 2),
  //      (0, "female", 42, 15, "yes", 3, 12, 3, 3),
  //      (0, "male", 27, 4, "yes", 3, 16, 3, 5),
  //      (0, "female", 27, 7, "yes", 3, 14, 1, 4),
  //      (0, "female", 22, 1.5, "no", 2, 14, 4, 5),
  //      (0, "female", 27, 4, "yes", 4, 14, 1, 4),
  //      (0, "female", 22, 4, "no", 4, 14, 5, 5),
  //      (0, "female", 22, 1.5, "no", 2, 16, 4, 5),
  //      (0, "male", 47, 15, "no", 4, 14, 5, 4),
  //      (0, "male", 37, 10, "yes", 2, 18, 6, 2),
  //      (0, "male", 37, 15, "yes", 3, 17, 5, 4),
  //      (0, "female", 27, 4, "yes", 2, 16, 1, 4),
  //      (3, "male", 27, 1.5, "no", 3, 18, 4, 4),
  //      (3, "female", 27, 4, "yes", 3, 17, 1, 5),
  //      (7, "male", 37, 15, "yes", 5, 18, 6, 2),
  //      (12, "female", 32, 10, "yes", 3, 17, 5, 2),
  //      (1, "male", 22, 0.125, "no", 4, 16, 5, 5),
  //      (1, "female", 22, 1.5, "yes", 2, 14, 1, 5),
  //      (12, "male", 37, 15, "yes", 4, 14, 5, 2),
  //      (7, "female", 22, 1.5, "no", 2, 14, 3, 4),
  //      (2, "male", 37, 15, "yes", 2, 18, 6, 4),
  //      (3, "female", 32, 15, "yes", 4, 12, 3, 2),
  //      (1, "female", 37, 15, "yes", 4, 14, 4, 2),
  //      (7, "female", 42, 15, "yes", 3, 17, 1, 4),
  //      (12, "female", 42, 15, "yes", 5, 9, 4, 1),
  //      (12, "male", 37, 10, "yes", 2, 20, 6, 2),
  //      (12, "female", 32, 15, "yes", 3, 14, 1, 2),
  //      (3, "male", 27, 4, "no", 1, 18, 6, 5),
  //      (7, "male", 37, 10, "yes", 2, 18, 7, 3),
  //      (7, "female", 27, 4, "no", 3, 17, 5, 5),
  //      (1, "male", 42, 15, "yes", 4, 16, 5, 5),
  //      (1, "female", 47, 15, "yes", 5, 14, 4, 5),
  //      (7, "female", 27, 4, "yes", 3, 18, 5, 4),
  //      (1, "female", 27, 7, "yes", 5, 14, 1, 4),
  //      (12, "male", 27, 1.5, "yes", 3, 17, 5, 4),
  //      (12, "female", 27, 7, "yes", 4, 14, 6, 2),
  //      (3, "female", 42, 15, "yes", 4, 16, 5, 4),
  //      (7, "female", 27, 10, "yes", 4, 12, 7, 3),
  //      (1, "male", 27, 1.5, "no", 2, 18, 5, 2),
  //      (1, "male", 32, 4, "no", 4, 20, 6, 4),
  //      (1, "female", 27, 7, "yes", 3, 14, 1, 3),
  //      (3, "female", 32, 10, "yes", 4, 14, 1, 4),
  //      (3, "male", 27, 4, "yes", 2, 18, 7, 2),
  //      (1, "female", 17.5, 0.75, "no", 5, 14, 4, 5),
  //      (1, "female", 32, 10, "yes", 4, 18, 1, 5),
  //      (7, "female", 32, 7, "yes", 2, 17, 6, 4),
  //      (7, "male", 37, 15, "yes", 2, 20, 6, 4),
  //      (7, "female", 37, 10, "no", 1, 20, 5, 3),
  //      (12, "female", 32, 10, "yes", 2, 16, 5, 5),
  //      (7, "male", 52, 15, "yes", 2, 20, 6, 4),
  //      (7, "female", 42, 15, "yes", 1, 12, 1, 3),
  //      (1, "male", 52, 15, "yes", 2, 20, 6, 3),
  //      (2, "male", 37, 15, "yes", 3, 18, 6, 5),
  //      (12, "female", 22, 4, "no", 3, 12, 3, 4),
  //      (12, "male", 27, 7, "yes", 1, 18, 6, 2),
  //      (1, "male", 27, 4, "yes", 3, 18, 5, 5),
  //      (12, "male", 47, 15, "yes", 4, 17, 6, 5),
  //      (12, "female", 42, 15, "yes", 4, 12, 1, 1),
  //      (7, "male", 27, 4, "no", 3, 14, 3, 4),
  //      (7, "female", 32, 7, "yes", 4, 18, 4, 5),
  //      (1, "male", 32, 0.417, "yes", 3, 12, 3, 4),
  //      (3, "male", 47, 15, "yes", 5, 16, 5, 4),
  //      (12, "male", 37, 15, "yes", 2, 20, 5, 4),
  //      (7, "male", 22, 4, "yes", 2, 17, 6, 4),
  //      (1, "male", 27, 4, "no", 2, 14, 4, 5),
  //      (7, "female", 52, 15, "yes", 5, 16, 1, 3),
  //      (1, "male", 27, 4, "no", 3, 14, 3, 3),
  //      (1, "female", 27, 10, "yes", 4, 16, 1, 4),
  //      (1, "male", 32, 7, "yes", 3, 14, 7, 4),
  //      (7, "male", 32, 7, "yes", 2, 18, 4, 1),
  //      (3, "male", 22, 1.5, "no", 1, 14, 3, 2),
  //      (7, "male", 22, 4, "yes", 3, 18, 6, 4),
  //      (7, "male", 42, 15, "yes", 4, 20, 6, 4),
  //      (2, "female", 57, 15, "yes", 1, 18, 5, 4),
  //      (7, "female", 32, 4, "yes", 3, 18, 5, 2),
  //      (1, "male", 27, 4, "yes", 1, 16, 4, 4),
  //      (7, "male", 32, 7, "yes", 4, 16, 1, 4),
  //      (2, "male", 57, 15, "yes", 1, 17, 4, 4),
  //      (7, "female", 42, 15, "yes", 4, 14, 5, 2),
  //      (7, "male", 37, 10, "yes", 1, 18, 5, 3),
  //      (3, "male", 42, 15, "yes", 3, 17, 6, 1),
  //      (1, "female", 52, 15, "yes", 3, 14, 4, 4),
  //      (2, "female", 27, 7, "yes", 3, 17, 5, 3),
  //      (12, "male", 32, 7, "yes", 2, 12, 4, 2),
  //      (1, "male", 22, 4, "no", 4, 14, 2, 5),
  //      (3, "male", 27, 7, "yes", 3, 18, 6, 4),
  //      (12, "female", 37, 15, "yes", 1, 18, 5, 5),
  //      (7, "female", 32, 15, "yes", 3, 17, 1, 3),
  //      (7, "female", 27, 7, "no", 2, 17, 5, 5),
  //      (1, "female", 32, 7, "yes", 3, 17, 5, 3),
  //      (1, "male", 32, 1.5, "yes", 2, 14, 2, 4),
  //      (12, "female", 42, 15, "yes", 4, 14, 1, 2),
  //      (7, "male", 32, 10, "yes", 3, 14, 5, 4),
  //      (7, "male", 37, 4, "yes", 1, 20, 6, 3),
  //      (1, "female", 27, 4, "yes", 2, 16, 5, 3),
  //      (12, "female", 42, 15, "yes", 3, 14, 4, 3),
  //      (1, "male", 27, 10, "yes", 5, 20, 6, 5),
  //      (12, "male", 37, 10, "yes", 2, 20, 6, 2),
  //      (12, "female", 27, 7, "yes", 1, 14, 3, 3),
  //      (3, "female", 27, 7, "yes", 4, 12, 1, 2),
  //      (3, "male", 32, 10, "yes", 2, 14, 4, 4),
  //      (12, "female", 17.5, 0.75, "yes", 2, 12, 1, 3),
  //      (12, "female", 32, 15, "yes", 3, 18, 5, 4),
  //      (2, "female", 22, 7, "no", 4, 14, 4, 3),
  //      (1, "male", 32, 7, "yes", 4, 20, 6, 5),
  //      (7, "male", 27, 4, "yes", 2, 18, 6, 2),
  //      (1, "female", 22, 1.5, "yes", 5, 14, 5, 3),
  //      (12, "female", 32, 15, "no", 3, 17, 5, 1),
  //      (12, "female", 42, 15, "yes", 2, 12, 1, 2),
  //      (7, "male", 42, 15, "yes", 3, 20, 5, 4),
  //      (12, "male", 32, 10, "no", 2, 18, 4, 2),
  //      (12, "female", 32, 15, "yes", 3, 9, 1, 1),
  //      (7, "male", 57, 15, "yes", 5, 20, 4, 5),
  //      (12, "male", 47, 15, "yes", 4, 20, 6, 4),
  //      (2, "female", 42, 15, "yes", 2, 17, 6, 3),
  //      (12, "male", 37, 15, "yes", 3, 17, 6, 3),
  //      (12, "male", 37, 15, "yes", 5, 17, 5, 2),
  //      (7, "male", 27, 10, "yes", 2, 20, 6, 4),
  //      (2, "male", 37, 15, "yes", 2, 16, 5, 4),
  //      (12, "female", 32, 15, "yes", 1, 14, 5, 2),
  //      (7, "male", 32, 10, "yes", 3, 17, 6, 3),
  //      (2, "male", 37, 15, "yes", 4, 18, 5, 1),
  //      (7, "female", 27, 1.5, "no", 2, 17, 5, 5),
  //      (3, "female", 47, 15, "yes", 2, 17, 5, 2),
  //      (12, "male", 37, 15, "yes", 2, 17, 5, 4),
  //      (12, "female", 27, 4, "no", 2, 14, 5, 5),
  //      (2, "female", 27, 10, "yes", 4, 14, 1, 5),
  //      (1, "female", 22, 4, "yes", 3, 16, 1, 3),
  //      (12, "male", 52, 7, "no", 4, 16, 5, 5),
  //      (2, "female", 27, 4, "yes", 1, 16, 3, 5),
  //      (7, "female", 37, 15, "yes", 2, 17, 6, 4),
  //      (2, "female", 27, 4, "no", 1, 17, 3, 1),
  //      (12, "female", 17.5, 0.75, "yes", 2, 12, 3, 5),
  //      (7, "female", 32, 15, "yes", 5, 18, 5, 4),
  //      (7, "female", 22, 4, "no", 1, 16, 3, 5),
  //      (2, "male", 32, 4, "yes", 4, 18, 6, 4),
  //      (1, "female", 22, 1.5, "yes", 3, 18, 5, 2),
  //      (3, "female", 42, 15, "yes", 2, 17, 5, 4),
  //      (1, "male", 32, 7, "yes", 4, 16, 4, 4),
  //      (12, "male", 37, 15, "no", 3, 14, 6, 2),
  //      (1, "male", 42, 15, "yes", 3, 16, 6, 3),
  //      (1, "male", 27, 4, "yes", 1, 18, 5, 4),
  //      (2, "male", 37, 15, "yes", 4, 20, 7, 3),
  //      (7, "male", 37, 15, "yes", 3, 20, 6, 4),
  //      (3, "male", 22, 1.5, "no", 2, 12, 3, 3),
  //      (3, "male", 32, 4, "yes", 3, 20, 6, 2),
  //      (2, "male", 32, 15, "yes", 5, 20, 6, 5),
  //      (12, "female", 52, 15, "yes", 1, 18, 5, 5),
  //      (12, "male", 47, 15, "no", 1, 18, 6, 5),
  //      (3, "female", 32, 15, "yes", 4, 16, 4, 4),
  //      (7, "female", 32, 15, "yes", 3, 14, 3, 2),
  //      (7, "female", 27, 7, "yes", 4, 16, 1, 2),
  //      (12, "male", 42, 15, "yes", 3, 18, 6, 2),
  //      (7, "female", 42, 15, "yes", 2, 14, 3, 2),
  //      (12, "male", 27, 7, "yes", 2, 17, 5, 4),
  //      (3, "male", 32, 10, "yes", 4, 14, 4, 3),
  //      (7, "male", 47, 15, "yes", 3, 16, 4, 2),
  //      (1, "male", 22, 1.5, "yes", 1, 12, 2, 5),
  //      (7, "female", 32, 10, "yes", 2, 18, 5, 4),
  //      (2, "male", 32, 10, "yes", 2, 17, 6, 5),
  //      (2, "male", 22, 7, "yes", 3, 18, 6, 2),
  //      (1, "female", 32, 15, "yes", 3, 14, 1, 5))
  //    val colArray: Array[String] = Array("affairs", "gender", "age", "yearsmarried", "children", "religiousness", "education", "occupation", "rating"
  //    )
  //    //array data2Dataframe
  //    val df = dataList.toDF(colArray: _*)

  val flowMap = TreeMap(
    "FEA_DS" -> "",
    "FEA_SAMPLE_SPLIT" -> "",
    "FEA_TRANSFORM" -> "",
    "TRAIN_FILTER" -> "",
    "TRAIN_TRAINER" -> ""
  )

  def getSrouce(str: String) = {

  }

  // from fea_ds get Dataframe
  val sourceDf = getSrouce(flowMap("FEA_DS"))

  def getSplitP(str: String) = {
    0.2
  }

  // get split parameters
  val splitPara = getSplitP(flowMap("FEA_DS"))

  //getDataFrame from FEA_DS
//  val data = tempLaoke
//  data.createOrReplaceTempView("data")
//
//  val labelWhere = "case when affairs=0 then 0 else cast(1 as double) end as label"
//  val genderWhere = "case when gender='female' then 0 else cast(1 as double) end as gender"
//  val childrenWhere = "case when children='no' then 0 else cast(1 as double) end as children"
//
//  val newDf = sql(s"select $labelWhere, $genderWhere,age,yearsmarried,$childrenWhere,religiousness,education,occupation,rating from data")


  val labelCol = "d14"
  //字段转为特征向量
  // "d14" ,"ad","day7","m1","m3","m6","m12","m18","m24","m60"
  val featuresArray = Array("day7","m1","m3","m6","m12","m18","m24","m60")

  val assembler = new VectorAssembler().setInputCols(featuresArray).setOutputCol("features")
  val vecDf = assembler.transform(baseDf).withColumnRenamed("d14", "label")

  vecDf.show(10, truncate = false)

  val Array(trainData, testData) = vecDf.randomSplit(Array( 1- splitPara, splitPara))

//  val numRound = 800
//  require(numRound > 10, "numRound must bigger than ten")

  val paramMap = List(
    "eta" -> 0.1f,
    "max_depth" -> 6, //数的最大深度。缺省值为6 ,取值范围为：[1,∞]
    "silent" -> 0, //取0时表示打印出运行时信息，取1时表示以缄默方式运行，不打印运行时信息。缺省值为0
    "objective" -> "reg:linear", //定义学习任务及相应的学习目标
    "eval_metric" -> "rmse", //校验数据所需要的评价指标
    "num_round" -> 10
    //"nthread"->  1  //XGBoost运行时的线程数。缺省值是当前系统可以获得的最大线程数

  ).toMap

  //    val trainDF = spark.sqlContext.read.format("libsvm").load(inputTrainPath)
  val xgboostModel = XGBoost.trainWithDataFrame(trainData, paramMap, 10, nWorkers = 2)
  xgboostModel.transform(testData).show()
}


